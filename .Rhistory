if(xpathSApply(html_code,"//GeocodeResponse//status",xmlValue)=="OK") {
lat = xpathSApply(html_code,"//result//geometry//location//lat",xmlValue)
lng = xpathSApply(html_code,"//result//geometry//location//lng",xmlValue)
loc_type = xpathSApply(html_code,"//result//geometry//location_type",xmlValue)
return(cbind(lat, lng, loc_type, address))
} else {
return(paste("Status:", xpathSApply(html_code,"//GeocodeResponse//status",xmlValue), sep = " "))
}
}
# Demo example
address <- c("台北市松江路124巷29號3樓", "台北市仁愛路二段88號13樓", "台北市德行東路358巷24弄10號")
geoPoint = function(address, verbose=FALSE) {
#若未輸入地址, return錯誤
if(verbose) cat(address,"\n")
root = "http://maps.google.com/maps/api/geocode/"
#Google編碼為UTF8, 中文要轉碼後帶入URL才會正確
# address = iconv(address,"big5","utf8")
#POI API型態(XML or JSON)
return.call = "xml"
sensor = "false"
#產生URL
url_gen = paste(root, return.call, "?address=", address, "&sensor=", sensor, sep = "")
#擷取網頁原始碼
html_code = xmlParse(url_gen)
#若status為OK抓取資料, 若不為OK return status
if(xpathSApply(html_code,"//GeocodeResponse//status",xmlValue)=="OK") {
lat = xpathSApply(html_code,"//result//geometry//location//lat",xmlValue)
lng = xpathSApply(html_code,"//result//geometry//location//lng",xmlValue)
loc_type = xpathSApply(html_code,"//result//geometry//location_type",xmlValue)
return(cbind(lat, lng, loc_type, address))
} else {
return(paste("Status:", xpathSApply(html_code,"//GeocodeResponse//status",xmlValue), sep = " "))
}
}
geoPoint("台北市")
strsplit(hospitalnew$固定看診時段,"、")
htime <- data.frame(strsplit(hospitalnew$固定看診時段,"、"))
View(htime)
library(reshape2)
long<-melt(strsplit(hospitalnew$固定看診時段,"、"),id.vars = c("醫事機構名稱","診療科別","固定看診時段"))
View(long)
long<-melt(hospitalnewnewcat,id.vars = c("醫事機構名稱","診療科別","固定看診時段"))
head(hospitalnewnewcat)
long<-melt(hospitalnewcat,id.vars = c("醫事機構名稱","診療科別","固定看診時段"))
head(hospitalnewcat)
View(long)
newtime <- strsplit(hospitalnew$固定看診時段,"、")
library(reshape2)
long<-melt(newtime,id.vars = c("醫事機構名稱","診療科別","固定看診時段"))
View(long)
sessionInfo()
1:20
listSample<-list(Students=c("Tom","Kobe","Emma"),
Year=2017,
Score=c(60,50,80,40),
School="CGU")
listSample
listSample[[1]]
listSample[1]
StuDF <- data.frame(StuID=c(1,2,3), ##欄位名稱=欄位值
name=c("小明","大雄","胖虎"),
score=c(80,60,90))
StuDF
colnames(StuDF)
rownames(StuDF)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
iris$Sepal.Length
source('~/.active-rstudio-document', echo=TRUE)
head(iris,20)
iris$Time<-1
names(iris)
View(iris)
table(iris)
table(iris$Sepal.Length)
dimnames(iris)
length(iris)
dim(iris)
class("Test")
class(1)
hospitalsep <- separate(hospitalnewcat, 固定看診時段, into, sep = " ", remove = TRUE, convert = FALSE)
install.packages("tidyr")
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, into, sep = " ", remove = TRUE, convert = FALSE)
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, into, sep = "、", remove = TRUE, convert = FALSE)
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, sep = "、", remove = TRUE, convert = FALSE)
?separate
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, into=time, sep = "、", remove = TRUE, convert = FALSE)
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, sep = "、")
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat$固定看診時段, sep = "、")
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, sep = "、")
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
hospitalsep <- separate(hospitalnewcat, 固定看診時段, into = "新固定看診時段", sep = "、")
separate(hospitalnewcat, 固定看診時段, into, sep = "、")
separate_DF <- long_DF %>% separate(hospitalnewcat, 固定看診時段)
head(separate_DF, 10)
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
View(category_DF)
long_DF <- category_DF %>% gather(看診時段, 固定看診時段, Qtr.1:Qtr.4)
head(long_DF)
?gather
separate_DF %>% separate(固定看診時段, into, sep = "、", remove = TRUE, convert = FALSE)
category_DF %>% separate(固定看診時段, into, sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- category_DF %>% separate(固定看診時段, c("Time_Interval", "Interval_ID"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- category_DF %>% separate(固定看診時段, c("固定看診時段"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- category_DF %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- hospitalnew %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- separate(category_DF, 固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- separate(hospitalnew, 固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- hospitalnew %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、", remove = TRUE, convert = FALSE)
separate_DF <- separate(hospitalnew, 固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、")
separate_DF <- hospitalnew %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、")
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
install.packages("readr")
library(readr)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
View(hospitalnew)
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
library(tidyr)
#切割營業時間
#strsplit(hospitalnew$固定看診時段,"、")
separate_DF <- separate(hospitalnew, 固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、")
separate_DF <- hospitalnew %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、")
View(separate_DF)
separate_DF <- category_DF %>% separate(固定看診時段, c("星期一、星期一、星期一、星期二、星期二、星期二、星期三、星期三、星期三、星期四、星期四、星期四、星期五、星期五、星期五、星期六、星期六、星期六、星期日、星期日、星期日"), sep = "、")
View(separate_DF)
separate_DF <- separate(category_DF, 固定看診時段, 新固定看診時段, sep = "、")
separate_DF <- separate(category_DF, 固定看診時段, "新固定看診時段", sep = "、")
View(separate_DF)
separate_DF <- separate(category_DF, 固定看診時段, c("新固定看診時段","新固定看診時段","新固定看診時段"), sep = "、")
View(separate_DF)
separate_DF <- separate(category_DF, 固定看診時段, c("新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段","新固定看診時段")
, sep = "、")
View(separate_DF)
?gather
long_DF <- separate_DF %>% gather(看診時段, 1:7083)
install.packages("reshape2")
library(reshape2)
long<-melt(separate_DF,id.vars = c("醫事機構名稱","診療科別","固定看診時段"))
long<-melt(separate_DF,id.vars = c("醫事機構名稱","診療科別","新固定看診時段"))
View(long)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
View(separate_DF)
long_DF <- separate_DF %>% gather(醫事機構名稱, 看診時段, 1:21)
View(long_DF)
View(long_DF)
?melt
long<-melt(separate_DF,id.vars = c("新固定看診時段"))
long<-melt(separate_DF,id.vars = 1:21)
View(long)
long<-melt(separate_DF,id.vars = c("醫事機構名稱","地址","診療科別"))
long <- melt(separate_DF,id.vars = c("醫事機構名稱","診療科別","地址"))
library(reshape2)
long <- melt(separate_DF,id.vars = c("醫事機構名稱","診療科別","地址"))
long <- melt(separate_DF,id.vars = c("醫事機構名稱","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","診療科別"))
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","診療科別"))
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","分區業務組","診療科別"))
View(long)
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
long <- melt(separate_DF,id.vars = colnames())
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","分區業務組","特約類別","服務項目","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話",separate_DF$`地 址`,"分區業務組","特約類別","服務項目","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話",separate_DF$地址,"分區業務組","特約類別","服務項目","診療科別"))
View(long)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
View(separate_DF)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
View(hospitalnew)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
library(readr)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
View(hospitalnew)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
View(hospitalnew)
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
View(category_DF)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
View(separate_DF)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
View(separate_DF)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","分區業務組","特約類別","服務項目","診療科別"))
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","分區業務組","特約類別","服務項目","診療科別"))
View(long)
long_DF <- separate_DF %>% gather(看診時段, 醫事機構名稱, 1:21)
View(long_DF)
long_DF <- separate_DF %>% gather(1:21, 看診時段, 醫事機構名稱)
long_DF <- separate_DF %>% gather(看診時段, 1:21, 醫事機構名稱)
?gather
long_DF <- gather(separate_DF, 看診時段, 1:21)
View(long_DF)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","分區業務組","特約類別","服務項目","診療科別"))
View(long)
long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","分區業務組","特約類別","服務項目","診療科別"))
long_DF <- gather(separate_DF, 看診時段, 1:21)
View(long_DF)
library(reshape2)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
install.packages("dplyr")
library(dplyr)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
install.packages("reshape2")
install.packages("dplyr")
library(reshape2)
library(dplyr)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
# install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
# 寬表轉長表
# install.packages("reshape2")
# install.packages("dplyr")
library(reshape2)
library(dplyr)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","分區業務組","特約類別","服務項目","診療科別"))
#long_DF <- gather(separate_DF, 看診時段, 1:21)
View(separate_DF)
library(reshape2)
library(dplyr)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
?setNames
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
library(reshape2)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
library(reshape2)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
library(readr)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, paste0("T",c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")))
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
library(reshape2)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, paste0("T",c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")))
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
library(reshape2)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
View(long_DF)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, paste0("T",c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")))
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
library(reshape2)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
install.packages("Data.table")
library(Data.table)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
library(Data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
library(reshape2)
library(dplyr)
library(Data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
install.packages("Data.table")
library(Data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
install.packages("data.table")
library(data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
library(reshape2)
library(dplyr)
library(data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("C:/Users/user/Desktop/hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
# install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")
, sep = "、")
# 寬表轉長表
# install.packages("reshape2")
# install.packages("dplyr")
# install.packages("data.table")
library(reshape2)
library(dplyr)
library(data.table)
setNames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#long <- melt(separate_DF,id.vars = c("醫事機構代碼","醫事機構名稱","醫事機構種類","電話","地址","分區業務組","特約類別","服務項目","診療科別"))
#long_DF <- gather(separate_DF, 看診時段, 1:21)
View(long_DF)
install.package("tidyverse")
library("tidyverse")
install.packages("tidyverse")
library("tidyverse")
?split
?strsplit
library("tidyverse")
split_DF <- split(long_DF$testvalue,3,2,2)
?substr
sub_DF <- substr(long_DF$testvalue,1:3,3:4,4:5)
sub_DF <- substr(long_DF$testvalue,1:3)
sub_DF <- substr(long_DF$testvalue,1:3,4:5)
substr("abcdef", 2, 4)
substring("abcdef", 1:6, 1:6)
sub_DF <- substr(long_DF$testvalue,1,3)
sub_DF
sub_DF <- data.frame(substr(long_DF$testvalue,1,3))
View(sub_DF)
sub_DF <- substr(long_DF$testvalue,1,3)
View(sub_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,3)
View(long_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,3)
long_DF$testvalue <- substr(long_DF$testvalue,4,5)
View(long_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,3) %>% substr(long_DF$testvalue,4,5)
substring("abcdef", 1:6, 1:6)
long_DF$testvalue <- substr(long_DF$testvalue,1:4,1:4)
View(long_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,5)
View(long_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,3)
View(long_DF)
long_DF$testvalue <- substr(long_DF$testvalue,1,3)
substr(long_DF$testvalue,1,3)
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
library(reshape2)
library(Data.table)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#install.packages("readr")
library(readr)
hospitalnew <- read_csv("hospitalnew.csv")
# View(hospitalnew)
# str(hospitalnew)
#篩選科別
category_DF <- hospitalnew[grep("兒科|婦產科|不分科|家醫科|耳鼻喉科", hospitalnew$診療科別), ]
#切割營業時間
#install.packages("tidyr")
library(tidyr)
separate_DF <- separate(category_DF, 固定看診時段, paste0("T",c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21")))
, sep = "、")
# 寬表轉長表
#install.packages("reshape2")
#install.packages("Data.table")
library(reshape2)
library(Data.table)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
#切割星期，時段，看診/休診
#Tidyverse,split,column
#install.packages("tidyverse")
# library("tidyverse")
#
# long_DF$testvalue <- substr(long_DF$testvalue,1,3)
# View(long_DF)
View(long_DF)
x <- c("asfef", "qwerty", "yuiop[", "b", "stuff.blah.yech")
substr(x, 2, 5)
substring(x, 2, 4:6)
long_DF$testvalue <- substr(long_DF$testvalue,1:3,5:6)
View(long_DF)
library(reshape2)
library(Data.table)
setnames(separate_DF,1,"醫事機構代碼")
long <- melt(separate_DF%>%select(醫事機構代碼,starts_with("T")),id.vars = c("醫事機構代碼"))
long_DF <- separate_DF%>%gather(test,testvalue, T1:T21)
substr(rep("abcdef", 4), 1:4, 4:5)
substr("abcdef", 2, 4)
substring(x, 2) <- c("..", "+++")
x
substr(rep(long_DF$testvalue,3),1:3,3:6)
substr(long_DF$testvalue,1:3,3:4,4:5)
substr(long_DF$testvalue,1,3,5)
substr(long_DF$testvalue,1:3,4:6)
